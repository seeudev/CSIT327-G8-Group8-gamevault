{% extends 'base.html' %}
{% load static %}

{% block title %}Purchase History - GameVault{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/modules/transactions.css' %}">
<link rel="stylesheet" href="{% static 'css/modules/animations.css' %}">
{% endblock %}

{% block content %}
<div class="transaction-history-modern">
    <div class="page-header">
        <h1 class="page-title">
            <span class="title-icon">📦</span>
            Purchase History
        </h1>
        <p class="page-subtitle">Track all your game purchases and download keys</p>
    </div>
    
    {% if transactions %}
        <div class="transactions-grid">
            {% for transaction in transactions %}
                <div class="transaction-card-modern" data-transaction-id="{{ transaction.id }}">
                    <div class="transaction-header">
                        <div class="order-badge">
                            <span class="badge-label">Order ID</span>
                            <span class="badge-number">#{{ transaction.id }}</span>
                        </div>
                        <div class="status-badge status-{{ transaction.payment_status }}">
                            {% if transaction.payment_status == 'completed' %}
                                <span class="status-icon">✓</span>
                            {% elif transaction.payment_status == 'pending' %}
                                <span class="status-icon">⏳</span>
                            {% else %}
                                <span class="status-icon">✗</span>
                            {% endif %}
                            {{ transaction.get_payment_status_display }}
                        </div>
                    </div>
                    
                    <div class="transaction-body">
                        <div class="transaction-info-grid">
                            <div class="info-block">
                                <span class="info-label">📅 Date</span>
                                <span class="info-value">{{ transaction.transaction_date|date:"M d, Y" }}</span>
                                <span class="info-time">{{ transaction.transaction_date|date:"h:i A" }}</span>
                            </div>
                            
                            <div class="info-block">
                                <span class="info-label">🎮 Items</span>
                                <span class="info-value">{{ transaction.items.count }}</span>
                                <span class="info-time">Game{{ transaction.items.count|pluralize }}</span>
                            </div>
                            
                            <div class="info-block price-block">
                                <span class="info-label">💰 Total</span>
                                <span class="info-value">${{ transaction.total_amount }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="transaction-footer">
                        <a href="{% url 'store:transaction_detail' transaction.id %}" class="btn-view-transaction">
                            <span>View Details</span>
                            <svg width="16" height="16" fill="currentColor">
                                <path d="M8 0 L16 8 L8 16 L6 14 L11 8 L6 2 Z"/>
                            </svg>
                        </a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <div class="empty-state-icon">🛒</div>
            <h3>No Purchases Yet</h3>
            <p>Start building your game library today!</p>
            <a href="{% url 'store:game_list' %}" class="btn-browse">
                🎮 Browse Games
            </a>
        </div>
    {% endif %}
</div>

{% block extra_js %}
<script src="{% static 'js/transaction-history.js' %}"></script>
{% endblock %}
{% endblock %}
